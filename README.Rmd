---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# petroOne

The goal of petroOne is to ...

## Installation

You can install petroOne from github with:

```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("f0nzie/petroOne")
```

## Examples

### Get the number of papers for *neural networks*.

```{r example}
library(petroOne)

my_url <- make_search_url(query = "neural network", how = "any")
my_url
get_papers_count(my_url)
# 3284
# 3314
```

### Read papers from from_year to to_year

```{r}
# neural network papers from 1990 to 2000. Exact phrase
my_url <- make_search_url(query = "neural network", 
                          from_year = 1990, 
                          to_year   = 2000, 
                          how = "all")
get_papers_count(my_url)
# 510
```

```{r}
library(petroOne)

my_url <- make_search_url(query = "neural network", 
                          from_year = 1990, 
                          to_year   = 1999, 
                          how = "all")

get_papers_count(my_url)
# 415
head(onepetro_page_to_dataframe(my_url))
```

### Get papers by document type (dc_type)

```{r}
# specify document type = "conference-paper", rows = 1000

my_url <- make_search_url(query = "neural network", 
                          how = "all",
                          dc_type = "conference-paper",
                          rows = 1000)

get_papers_count(my_url)
# 2661
# 2687
head(onepetro_page_to_dataframe(my_url))
```



```{r}
# specify document type = "journal-paper", rows = 1000

my_url <- make_search_url(query = "neural network", 
                          how = "all",
                          dc_type = "journal-paper",
                          rows = 1000)

get_papers_count(my_url)
# 303
# 304
head(onepetro_page_to_dataframe(my_url))
```

## Summaries

```{r}
library(petroOne)

my_url <- make_search_url(query = "well test", 
                          how = "all")

result <- read_onepetro(my_url)

head(summary_by_doctype(result))
head(summary_by_publisher(result))
head(summary_by_dates(result))
head(summary_by_publications(result))

```

## Get total number of papers 
in multiple pages of 1000 rows (or papers each)

```{r}
# we use "conference-paper" only because other document types have
# different dataframe structure

my_url <- make_search_url(query = "neural network", 
                          how = "all",
                          dc_type = "conference-paper",
                          rows = 1000)

get_papers_count(my_url)
# 2661
# 2697 @ 200171009
```

### Collect first 1000 rows out of 2661

```{r}
outdir <- system.file("out", package = "petroOne")

```


```{r}
my_url_1 <- make_search_url(query = "neural network", 
                          how = "all", 
                          dc_type = "conference-paper",
                          start = 0,
                          rows  = 1000)

get_papers_count(my_url_1)

page_1 <- read_onepetro(my_url_1)
htm_1 <- paste(outdir, "1000_conference.html", sep = "/")
xml2::write_html(page_1, file = htm_1)
head(onepetro_page_to_dataframe(htm_1))
```


### Collect second set of 1000 rows out of 2661

```{r}
my_url_2 <- make_search_url(query = "neural network", 
                          how = "all", 
                          dc_type = "conference-paper",
                          start = 1000,
                          rows  = 1000)

page_2 <- read_onepetro(my_url_2)
htm_2 <- paste(outdir, "2000_conference.html", sep = "/")
xml2::write_html(page_2, file = htm_2)
head(onepetro_page_to_dataframe(htm_2))
```

### Collect remaining set of 1000 rows out of 2661

```{r}
my_url_3 <- make_search_url(query = "neural network", 
                          how = "all", 
                          dc_type = "conference-paper",
                          start = 2000,
                          rows  = 1000)

page_3 <- read_onepetro(my_url_3)
htm_3 <- paste(outdir, "3000_conference.html", sep = "/")
xml2::write_html(page_3, file = htm_3)
head(onepetro_page_to_dataframe(htm_3))
```






